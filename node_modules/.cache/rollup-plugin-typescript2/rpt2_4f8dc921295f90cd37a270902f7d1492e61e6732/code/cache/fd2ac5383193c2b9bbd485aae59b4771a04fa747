{"code":"import { useState } from 'react';\r\nimport { R } from 'lib/utils';\r\nexport function useField({ key, label, initialValue, validationRules, isRequired, placeholder, validateOnBlur = false, liveParser, submitParser }) {\r\n    const [field, setField] = useState({\r\n        value: initialValue,\r\n        isPristine: true,\r\n        errorMessage: ''\r\n    });\r\n    const computeErrorMessage = (value, forceCheck = false) => {\r\n        if ((!forceCheck && field.isPristine) || !validationRules) {\r\n            return '';\r\n        }\r\n        const val = (R.isDefined(value)\r\n            ? value\r\n            : field.value);\r\n        if (isRequired && R.isEmpty(val)) {\r\n            return validationRules[0].errorMessage;\r\n        }\r\n        if (!isRequired && R.isEmpty(val)) {\r\n            return '';\r\n        }\r\n        const firstError = validationRules\r\n            .find(rule => !rule.validate(val));\r\n        return firstError\r\n            ? firstError.errorMessage\r\n            : '';\r\n    };\r\n    return {\r\n        key,\r\n        label,\r\n        isRequired,\r\n        placeholder,\r\n        submitParser,\r\n        value: field.value,\r\n        hasChange: field.value !== initialValue,\r\n        errorMessage: field.errorMessage,\r\n        onBlur: () => setField(prevState => ({\r\n            ...prevState,\r\n            isPristine: false,\r\n            errorMessage: computeErrorMessage(undefined, true)\r\n        })),\r\n        onChangeValue: (newValue) => setField(prevState => ({\r\n            ...prevState,\r\n            value: liveParser\r\n                ? liveParser(newValue)\r\n                : newValue,\r\n            isPristine: prevState.isPristine\r\n                ? validateOnBlur\r\n                : prevState.isPristine,\r\n            errorMessage: computeErrorMessage(newValue)\r\n        })),\r\n        validateOnSubmit: () => {\r\n            const errorMessage = computeErrorMessage(undefined, true);\r\n            if (errorMessage) {\r\n                setField(prevState => ({\r\n                    ...prevState,\r\n                    errorMessage\r\n                }));\r\n                return errorMessage;\r\n            }\r\n            return '';\r\n        },\r\n        setError: (errorMessage) => setField(prevState => ({\r\n            ...prevState,\r\n            errorMessage\r\n        }))\r\n    };\r\n}\r\n//# sourceMappingURL=useField.js.map","references":["/Users/grzegorztarnopolski/Documents/projects/react-form-builder-v2/node_modules/@types/react/index.d.ts","/Users/grzegorztarnopolski/Documents/projects/react-form-builder-v2/src/lib/utils/index.ts","/Users/grzegorztarnopolski/Documents/projects/react-form-builder-v2/src/main/types.ts"],"map":"{\"version\":3,\"file\":\"useField.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../src/main/useField.ts\"],\"names\":[],\"mappings\":\"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\"}"}
